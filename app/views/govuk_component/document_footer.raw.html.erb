<%
  from ||= []
  from = Array(from)

  part_of ||= []
  part_of = Array(part_of)

  history ||= []
  history = Array(history)

  other ||= nil

  other_dates ||= nil

  direction_class = ""
  direction_class = " direction-#{direction}" if local_assigns.include?(:direction)

  require 'securerandom'

  uuid = SecureRandom.uuid
%>
<div class="govuk-document-footer<%= direction_class %>">
  <h2 class="visuallyhidden">
    <%= t("govuk_component.document_footer.document_information", default: "Document information") %>
  </h2>
  <div class="history-information" id="history-<%= uuid %>">
    <dl>
      <% if local_assigns.include?(:published) && published %>
        <dt>
          <%= t("govuk_component.document_footer.published", default: "Published") %>:
        </dt>
        <dd class="published definition"><%= published %></dd>
      <% end %>
      <% if local_assigns.include?(:updated) && updated %>
        <dt>
          <%= t("govuk_component.document_footer.updated", default: "Updated") %>:
        </dt>
        <dd class="updated definition"><%= updated %></dd>
      <% end %>
      <% if other_dates.present? %>
        <% other_dates.each do |title, date| %>
          <dt><%= title %>:</dt>
          <dd class="other-date definition"><%= date %></dd>
        <% end %>
      <% end %>
    </dl>
    <% if history.any? %>
      <div class="change-notes" data-module="toggle">
        <p>
          <a href="#full-history-<%= uuid %>" data-controls="full-history-<%= uuid %>" data-expanded="false">
            + <%= t("govuk_component.document_footer.full_page_history", default: "full page history") %>
          </a>
        </p>
        <div class="js-hidden" id="full-history-<%= uuid %>"><span class="arrow"></span>
          <ol>
            <% history.each do |change| %>
              <li>
                <time datetime="<%= change[:timestamp] %>" class="timestamp"><%= change[:display_time] %></time>
                <%= change[:note] %>
              </li>
            <% end %>
          </ol>
        </div>
      </div>
    <% end %>
  </div>
  <div class="related-information">
    <dl>
      <% if from.any? %>
        <dt>From:</dt>
        <dd>
          <% from.each do |definition| %>
            <span class="definition">
              <%= definition.html_safe %>
            </span>
          <% end %>
        </dd>
      <% end %>
      <% if part_of.any? %>
        <dt>
          <%= t("govuk_component.document_footer.part_of", default: "Part of") %>:
        </dt>
        <dd>
          <% part_of.each do |definition| %>
          <span class="definition">
            <%= definition.html_safe %>
          </span>
          <% end %>
        </dd>
      <% end %>
      <% if other.present? %>
        <% other.each do |title, definitions| %>
          <%
            definitions ||= []
            definitions = Array(definitions)
          %>
          <% if definitions.any? %>
            <dt><%= title %>:</dt>
            <dd>
              <% definitions.each do |definition| %>
                <span class="definition">
                  <%= definition.html_safe %>
                </span>
              <% end %>
            </dd>
          <% end %>
        <% end %>
      <% end %>
    </dl>
  </div>
</div>
